<!DOCTYPE html>
<html lang="pt-BR">
<head>
    {% load static %}
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Editar Colaborador</title>
    <link rel="icon" href="{% static 'imagens/favicon.ico' %}" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --light-bg: #f8f9fa;
            --card-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--light-bg);
            line-height: 1.6;
        }
        
        .card {
            border-radius: 0.75rem;
            border: none;
            box-shadow: var(--card-shadow);
        }
        
        h2 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        
        h4 {
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #dee2e6;
            margin: 1.5rem 0 1rem;
            display: flex;
            align-items: center;
        }
        
        h4 span {
            margin-right: 0.5rem;
        }
        
        .form-label {
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .btn {
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: #0069d9;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        @media (max-width: 767.98px) {
            .card-body {
                padding: 1.5rem !important;
            }
            
            .row.g-3 > [class^="col-"] {
                margin-bottom: 1rem;
            }
            
            .d-flex.justify-content-end {
                flex-direction: column;
                gap: 1rem;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        #conselho_profissional_section {
            display: none;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container py-3 py-md-4">
        <div class="card shadow-lg">
            <div class="card-body p-3 p-md-4">
                <h2 class="text-center text-primary">Editar Colaborador</h2>
                
                {% if messages %}
                    <div class="mb-4">
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
                
                <form method="post" class="needs-validation" novalidate>
                    {% csrf_token %}
                    
                    <!-- Se√ß√£o 1: Identifica√ß√£o -->
                    <section>
                        <h4><span>üìå</span>1. Identifica√ß√£o</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-4">
                                <label for="id_matricula" class="form-label">Matr√≠cula</label>
                                <input type="text" name="matricula" id="id_matricula" class="form-control" value="{{ colaborador.matricula }}" required />
                            </div>
                            <div class="col-md-8">
                                <label for="id_nome_completo" class="form-label">Nome Completo</label>
                                <input type="text" name="nome_completo" id="id_nome_completo" class="form-control" value="{{ colaborador.nome_completo }}" required />
                            </div>
                        </div>
                    </section>
                    
                    <!-- Se√ß√£o 2: Dados Profissionais -->
                    <section>
                        <h4><span>üßë‚Äçüíº</span>2. Dados Profissionais</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-4">
                                <label for="id_cargo" class="form-label">Cargo</label>
                                <select name="cargo" id="id_cargo" class="form-select">
                                    <option value="">Selecione o Cargo</option>
                                    <option value="medico" {% if colaborador.cargo == "medico" %}selected{% endif %}>M√©dico</option>
                                    <option value="analista" {% if colaborador.cargo == "analista" %}selected{% endif %}>Analista em Sa√∫de</option>
                                    <option value="assistente" {% if colaborador.cargo == "assistente" %}selected{% endif %}>Assistente em Sa√∫de</option>
                                    <option value="auxiliar" {% if colaborador.cargo == "auxiliar" %}selected{% endif %}>Auxiliar em Sa√∫de</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="id_funcao" class="form-label">Fun√ß√£o Espec√≠fica</label>
                                <input type="text" name="funcao" id="id_funcao" class="form-control" value="{{ colaborador.funcao }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_data_admissao" class="form-label">Data de Admiss√£o</label>
                                <input type="date" name="data_admissao" id="id_data_admissao" class="form-control" value="{{ colaborador.data_admissao|date:'Y-m-d' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_setor_trabalho" class="form-label">Setor de Trabalho</label>
                                <select name="setor_trabalho" id="id_setor_trabalho" class="form-select">
                                    <option value="">Selecione o Setor</option>
                                    <option value="almoxarifado" {% if colaborador.setor_trabalho == "almoxarifado" %}selected{% endif %}>Almoxarifado</option>
                                    <option value="ambulatorio" {% if colaborador.setor_trabalho == "ambulatorio" %}selected{% endif %}>Ambulat√≥rio</option>
                                    <option value="administrativo" {% if colaborador.setor_trabalho == "ambulatorio" %}selected{% endif %}>Administrativo</option>
                                    <option value="bloco_cirurgico" {% if colaborador.setor_trabalho == "bloco_cirurgico" %}selected{% endif %}>Bloco Cir√∫rgico</option>
                                    <option value="ccih" {% if colaborador.setor_trabalho == "ccih" %}selected{% endif %}>CCIH</option>
                                    <option value="clinica_cirurgica" {% if colaborador.setor_trabalho == "clinica_cirurgica" %}selected{% endif %}>Cl√≠nica Cir√∫rgica</option>
                                    <option value="clinica_ortopedica" {% if colaborador.setor_trabalho == "clinica_ortopedica" %}selected{% endif %}>Cl√≠nica Ortop√©dica</option>
                                    <option value="epidemiologia" {% if colaborador.setor_trabalho == "epidemiologia" %}selected{% endif %}>Epidemiologia</option>
                                    <option value="farmacia" {% if colaborador.setor_trabalho == "farmacia" %}selected{% endif %}>Farm√°cia</option>
                                    <option value="imobilizacao" {% if colaborador.setor_trabalho == "imobilizacao" %}selected{% endif %}>Imobiliza√ß√£o</option>
                                    <option value="maternidade" {% if colaborador.setor_trabalho == "maternidade" %}selected{% endif %}>Maternidade</option>
                                    <option value="recepcao" {% if colaborador.setor_trabalho == "recepcao" %}selected{% endif %}>Recep√ß√£o</option>
                                    <option value="same" {% if colaborador.setor_trabalho == "same" %}selected{% endif %}>SAME</option>
                                    <option value="uti" {% if colaborador.setor_trabalho == "uti" %}selected{% endif %}>UTI</option>
                                    <option value="dp" {% if colaborador.setor_trabalho == "dp" %}selected{% endif %}>Departamento Pessoal</option>
                                    <option value="plantonista" {% if colaborador.setor_trabalho == "plantonista" %}selected{% endif %}>Plantonista</option>
                                    <option value="evolucionista" {% if colaborador.setor_trabalho == "evolucionista" %}selected{% endif %}>Evolucionista</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="id_turno" class="form-label">Turno</label>
                                <select name="turno" id="id_turno" class="form-select">
                                    <option value="">Selecione o Turno</option>
                                    <option value="manha" {% if colaborador.turno == "manha" %}selected{% endif %}>Manh√£</option>
                                    <option value="tarde" {% if colaborador.turno == "tarde" %}selected{% endif %}>Tarde</option>
                                    <option value="noite" {% if colaborador.turno == "noite" %}selected{% endif %}>Noite</option>
                                    <option value="plantonista" {% if colaborador.turno == "plantonista" %}selected{% endif %}>Plantonista</option>
                                    <option value="diarista" {% if colaborador.turno == "diarista" %}selected{% endif %}>Diarista</option>
                                    <option value="segunda" {% if colaborador.turno == "segunda" %}selected{% endif %}>Segunda-Feira</option>
                                    <option value="terca" {% if colaborador.turno == "terca" %}selected{% endif %}>Ter√ßa-Feira</option>
                                    <option value="quarta" {% if colaborador.turno == "quarta" %}selected{% endif %}>Quarta-Feira</option>
                                    <option value="quinta" {% if colaborador.turno == "quinta" %}selected{% endif %}>Quinta-Feira</option>
                                    <option value="sexta" {% if colaborador.turno == "sexta" %}selected{% endif %}>Sexta-Feira</option>
                                    <option value="sabado" {% if colaborador.turno == "sabado" %}selected{% endif %}>S√°bado</option>
                                    <option value="domingo" {% if colaborador.turno == "domingo" %}selected{% endif %}>Domingo</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="id_dias_trabalho" class="form-label">Dias de Trabalho</label>
                                <input type="text" name="dias_trabalho" id="id_dias_trabalho" class="form-control" value="{{ colaborador.dias_trabalho }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_jornada_trabalho" class="form-label">Jornada de Trabalho (Horas)</label>
                                <input type="text" name="jornada_trabalho" id="id_jornada_trabalho" class="form-control" value="{{ colaborador.jornada_trabalho }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_tipo_contrato" class="form-label">Tipo de Contrato</label>
                                <input type="text" name="tipo_contrato" id="id_tipo_contrato" class="form-control" value="{{ colaborador.tipo_contrato }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_status" class="form-label">Status</label>
                                <select name="status" id="id_status" class="form-select">
                                    <option value="">Selecione o Status</option>
                                    <option value="ativo" {% if colaborador.status == "ativo" %}selected{% endif %}>Ativo</option>
                                    <option value="inativo" {% if colaborador.status == "inativo" %}selected{% endif %}>Inativo</option>
                                    <option value="ferias" {% if colaborador.status == "ferias" %}selected{% endif %}>F√©rias</option>
                                    <option value="afastado" {% if colaborador.status == "afastado" %}selected{% endif %}>Afastado</option>
                                    <option value="licencan" {% if colaborador.status == "licencan" %}selected{% endif %}>Licen√ßa Nojo</option>
                                    <option value="licencag" {% if colaborador.status == "licencag" %}selected{% endif %}>Licen√ßa Gala</option>
                                    <option value="licencam" {% if colaborador.status == "licencam" %}selected{% endif %}>Licen√ßa Maternidade</option>
                                    <option value="licencap" {% if colaborador.status == "licencap" %}selected{% endif %}>Licen√ßa Paternidade</option>
                                    <option value="licencae" {% if colaborador.status == "licencae" %}selected{% endif %}>Licen√ßa Eleitoral</option>
                                    <option value="licencat" {% if colaborador.status == "licencat" %}selected{% endif %}>Licen√ßa de Trato e Interesse Particular</option>
                                    <option value="licencaedu" {% if colaborador.status == "licencaedu" %}selected{% endif %}>Licen√ßa Estudo</option>
                                    <option value="licencapremio" {% if colaborador.status == "licencapremio" %}selected{% endif %}>Licen√ßa Pr√™mio</option>
                                    <option value="demitido" {% if colaborador.status == "demitido" %}selected{% endif %}>Demitido</option>
                                    <option value="exonerado" {% if colaborador.status == "exonerado" %}selected{% endif %}>Exonerado</option>
                                </select>
                            </div>
                        </div>

                        <div id="conselho_profissional_section" class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-4">
                                <label for="id_numero_conselho" class="form-label">N√∫mero do Conselho Profissional</label>
                                <input type="text" name="numero_conselho" id="id_numero_conselho" class="form-control" value="{{ colaborador.numero_conselho|default_if_none:'' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_uf_conselho" class="form-label">UF do Conselho</label>
                                <input type="text" name="uf_conselho" id="id_uf_conselho" class="form-control" value="{{ colaborador.uf_conselho|default_if_none:'' }}" maxlength="2" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_nome_conselho" class="form-label">Nome do Conselho</label>
                                <input type="text" name="nome_conselho" id="id_nome_conselho" class="form-control" value="{{ colaborador.nome_conselho|default_if_none:'' }}" />
                            </div>
                        </div>
                    </section>

                    <!-- Se√ß√£o 3: Informa√ß√µes Familiares -->
                    <section>
                        <h4><span>üë™</span>3. Informa√ß√µes Familiares</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-6">
                                <label for="id_nome_mae" class="form-label">Nome da M√£e</label>
                                <input type="text" name="nome_mae" id="id_nome_mae" class="form-control" value="{{ colaborador.nome_mae }}" />
                            </div>
                            <div class="col-md-6">
                                <label for="id_nome_pai" class="form-label">Nome do Pai (Opcional)</label>
                                <input type="text" name="nome_pai" id="id_nome_pai" class="form-control" value="{{ colaborador.nome_pai|default_if_none:'' }}" />
                            </div>
                        </div>
                    </section>

                    <!-- Se√ß√£o 4: Dados Pessoais -->
                    <section>
                        <h4><span>üéÇ</span>4. Dados Pessoais</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-4">
                                <label for="id_data_nascimento" class="form-label">Data de Nascimento</label>
                                <input type="date" name="data_nascimento" id="id_data_nascimento" class="form-control" value="{{ colaborador.data_nascimento|date:'Y-m-d' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_naturalidade" class="form-label">Naturalidade (Cidade/UF)</label>
                                <input type="text" name="naturalidade" id="id_naturalidade" class="form-control" value="{{ colaborador.naturalidade }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_estado_civil" class="form-label">Estado Civil</label>
                                <select name="estado_civil" id="id_estado_civil" class="form-select">
                                    <option value="">Selecione</option>
                                    <option value="solteiro" {% if colaborador.estado_civil == "solteiro" %}selected{% endif %}>Solteiro(a)</option>
                                    <option value="casado" {% if colaborador.estado_civil == "casado" %}selected{% endif %}>Casado(a)</option>
                                    <option value="divorciado" {% if colaborador.estado_civil == "divorciado" %}selected{% endif %}>Divorciado(a)</option>
                                    <option value="viuvo" {% if colaborador.estado_civil == "viuvo" %}selected{% endif %}>Vi√∫vo(a)</option>
                                    <option value="uniao_estavel" {% if colaborador.estado_civil == "uniao_estavel" %}selected{% endif %}>Uni√£o Est√°vel</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="id_cpf" class="form-label">CPF</label>
                                <input type="text" name="cpf" id="id_cpf" class="form-control cpf-mask" value="{{ colaborador.cpf }}" required />
                            </div>
                            <div class="col-md-4">
                                <label for="id_rg_completo" class="form-label">RG (N√∫mero e √ìrg√£o Emissor)</label>
                                <input type="text" name="rg_completo" id="id_rg_completo" class="form-control" value="{{ colaborador.rg_completo }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_numero_ctps" class="form-label">N√∫mero da CTPS</label>
                                <input type="text" name="numero_ctps" id="id_numero_ctps" class="form-control" value="{{ colaborador.numero_ctps }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_serie_ctps" class="form-label">S√©rie da CTPS</label>
                                <input type="text" name="serie_ctps" id="id_serie_ctps" class="form-control" value="{{ colaborador.serie_ctps }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_uf_ctps" class="form-label">UF da CTPS</label>
                                <input type="text" name="uf_ctps" id="id_uf_ctps" class="form-control" value="{{ colaborador.uf_ctps }}" maxlength="2" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_titulo_eleitor" class="form-label">T√≠tulo de Eleitor</label>
                                <input type="text" name="titulo_eleitor" id="id_titulo_eleitor" class="form-control" value="{{ colaborador.titulo_eleitor|default_if_none:'' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_zona_eleitoral" class="form-label">Zona Eleitoral</label>
                                <input type="text" name="zona_eleitoral" id="id_zona_eleitoral" class="form-control" value="{{ colaborador.zona_eleitoral }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_secao_eleitoral" class="form-label">Se√ß√£o Eleitoral</label>
                                <input type="text" name="secao_eleitoral" id="id_secao_eleitoral" class="form-control" value="{{ colaborador.secao_eleitoral }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_estado_vota" class="form-label">Estado onde Vota</label>
                                <input type="text" name="estado_vota" id="id_estado_vota" class="form-control" value="{{ colaborador.estado_vota }}" maxlength="2" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_documento_militar" class="form-label">Documento Militar (Opcional)</label>
                                <input type="text" name="documento_militar" id="id_documento_militar" class="form-control" value="{{ colaborador.documento_militar|default_if_none:'' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_grau_instrucao" class="form-label">Grau de Instru√ß√£o</label>
                                <input type="text" name="grau_instrucao" id="id_grau_instrucao" class="form-control" value="{{ colaborador.grau_instrucao }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_numero_pasep" class="form-label">N√∫mero do PASEP (Opcional)</label>
                                <input type="text" name="numero_pasep" id="id_numero_pasep" class="form-control" value="{{ colaborador.numero_pasep|default_if_none:'' }}" />
                            </div>
                        </div>
                    </section>

                    <!-- Se√ß√£o 5: Contato -->
                    <section>
                        <h4><span>üìû</span>5. Contato</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-4">
                                <label for="id_celular" class="form-label">Celular</label>
                                <input type="tel" name="celular" id="id_celular" class="form-control sp-celphones" value="{{ colaborador.celular }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_telefone_fixo" class="form-label">Telefone Fixo (Opcional)</label>
                                <input type="tel" name="telefone_fixo" id="id_telefone_fixo" class="form-control sp-phones" value="{{ colaborador.telefone_fixo|default_if_none:'' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_email" class="form-label">E-mail</label>
                                <input type="email" name="email" id="id_email" class="form-control" value="{{ colaborador.email }}" />
                            </div>
                        </div>
                    </section>

                    <!-- Se√ß√£o 6: Endere√ßo -->
                    <section>
                        <h4><span>üè†</span>6. Endere√ßo</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-md-3">
                                <label for="id_cep" class="form-label">CEP</label>
                                <input type="text" name="cep" id="id_cep" class="form-control cep-mask" value="{{ colaborador.cep }}" />
                            </div>
                            <div class="col-md-7">
                                <label for="id_endereco" class="form-label">Logradouro</label>
                                <input type="text" name="endereco" id="id_endereco" class="form-control" value="{{ colaborador.endereco }}" />
                            </div>
                            <div class="col-md-2">
                                <label for="id_numero" class="form-label">N√∫mero</label>
                                <input type="text" name="numero" id="id_numero" class="form-control" value="{{ colaborador.numero }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_complemento" class="form-label">Complemento (Opcional)</label>
                                <input type="text" name="complemento" id="id_complemento" class="form-control" value="{{ colaborador.complemento|default_if_none:'' }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_bairro" class="form-label">Bairro</label>
                                <input type="text" name="bairro" id="id_bairro" class="form-control" value="{{ colaborador.bairro }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_cidade" class="form-label">Cidade</label>
                                <input type="text" name="cidade" id="id_cidade" class="form-control" value="{{ colaborador.cidade }}" />
                            </div>
                            <div class="col-md-4">
                                <label for="id_uf" class="form-label">UF</label>
                                <input type="text" name="uf" id="id_uf" class="form-control" value="{{ colaborador.uf }}" maxlength="2" />
                            </div>
                        </div>
                    </section>

                    <!-- Se√ß√£o 7: Observa√ß√µes -->
                    <section>
                        <h4><span>üìù</span>7. Observa√ß√µes</h4>
                        <div class="row g-3 g-md-4 mb-3 mb-md-4">
                            <div class="col-12">
                                <label for="id_observacoes" class="form-label">Informa√ß√µes Adicionais</label>
                                <textarea name="observacoes" id="id_observacoes" class="form-control" rows="4">{{ colaborador.observacoes|default_if_none:'' }}</textarea>
                            </div>
                        </div>
                    </section>

                    <!-- Bot√µes de a√ß√£o -->
                    <div class="d-flex flex-column flex-md-row justify-content-end gap-3 mt-4 pt-3 border-top">
                        <a href="{% url 'tarefas:listar_colaboradores' %}" class="btn btn-secondary">Cancelar</a>
                        <button type="submit" class="btn btn-primary">Salvar Altera√ß√µes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <script>
        $(document).ready(function(){
            // M√°scaras
            $('.cpf-mask').mask('000.000.000-00');
            $('.cep-mask').mask('00000-000');
            $('.sp-celphones').mask('(00) 00000-0000');
            $('.sp-phones').mask('(00) 0000-0000');

            // L√≥gica para mostrar/esconder a se√ß√£o de Conselho Profissional
            function toggleConselhoFields() {
                var cargo = $('#id_cargo').val();
                if (cargo === 'medico' || cargo === 'analista' || cargo === 'assistente') {
                    $('#conselho_profissional_section').slideDown();
                } else {
                    $('#conselho_profissional_section').slideUp();
                }
            }

            // Inicializa√ß√£o e evento change
            toggleConselhoFields();
            $('#id_cargo').change(toggleConselhoFields);
        });
    </script>
</body>
</html>